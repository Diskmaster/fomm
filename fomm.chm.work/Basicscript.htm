<html><head><meta name="generator" content="Help & Manual 2.7.0"><title>Basic script</title></head>
<body bgcolor="#FFFFFF">
<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#C0C0C0"><tr><td align="left">
<font face="Arial" size="3" color="#000000"><b>Basic script
<br>
</b></font>

</td><td align="right"><font face="Arial" size="2"><a href="emptyscript.htm">[Previous]</a> <a href="falloutmodmanager.htm">[Main]</a> <a href="shaderediting.htm">[Next]</a></font></td></tr></table><br>

<font face="Courier New" size="2" color="#000000"><font face="Courier New" size="2" color="#008000">//An&nbsp;installation&nbsp;script&nbsp;that&nbsp;performs&nbsp;identically&nbsp;to&nbsp;what&nbsp;fomm&nbsp;would&nbsp;do&nbsp;if&nbsp;no&nbsp;script&nbsp;were&nbsp;present
<br>
//All&nbsp;files&nbsp;in&nbsp;the&nbsp;fomod&nbsp;outside&nbsp;of&nbsp;the&nbsp;fomod&nbsp;directory&nbsp;will&nbsp;be&nbsp;installed,&nbsp;all&nbsp;plugins&nbsp;will&nbsp;be&nbsp;activated
<br>
//Plugins&nbsp;will&nbsp;end&nbsp;up&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;end&nbsp;of&nbsp;your&nbsp;load&nbsp;order&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;were&nbsp;extracted
<br>

<br>
</font><font face="Courier New" size="2" color="#000000"><font face="Courier New" size="2" color="#0000FF">using</font></font><font face="Courier New" size="2" color="#000000">&nbsp;System;
<br>
<font face="Courier New" size="2" color="#0000FF">using</font></font><font face="Courier New" size="2" color="#000000">&nbsp;System.IO;
<br>
<font face="Courier New" size="2" color="#0000FF">using</font></font><font face="Courier New" size="2" color="#000000">&nbsp;fomm.Scripting;
<br>

<br>
<font face="Courier New" size="2" color="#0000FF">class</font></font><font face="Courier New" size="2" color="#000000">&nbsp;<font face="Courier New" size="2" color="#2B91AF">Script</font></font><font face="Courier New" size="2" color="#000000">&nbsp;:&nbsp;<font face="Courier New" size="2" color="#2B91AF">BaseScript</font></font><font face="Courier New" size="2" color="#000000">&nbsp;{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">public&nbsp;static&nbsp;bool</font></font><font face="Courier New" size="2" color="#000000">&nbsp;OnActivate()&nbsp;{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">char</font></font><font face="Courier New" size="2" color="#000000">[]&nbsp;seperators=<font face="Courier New" size="2" color="#0000FF">new</font></font><font face="Courier New" size="2" color="#000000">&nbsp;<font face="Courier New" size="2" color="#0000FF">char</font></font><font face="Courier New" size="2" color="#000000">[]&nbsp;{&nbsp;<font face="Courier New" size="2" color="#2B91AF">Path</font></font><font face="Courier New" size="2" color="#000000">.DirectorySeparatorChar,&nbsp;<font face="Courier New" size="2" color="#2B91AF">Path</font></font><font face="Courier New" size="2" color="#000000">.AltDirectorySeparatorChar&nbsp;};
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">foreach</font></font><font face="Courier New" size="2" color="#000000">(<font face="Courier New" size="2" color="#0000FF">string</font></font><font face="Courier New" size="2" color="#000000">&nbsp;file&nbsp;<font face="Courier New" size="2" color="#0000FF">in</font></font><font face="Courier New" size="2" color="#000000">&nbsp;GetFomodFileList())&nbsp;{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstallFileFromFomod(file);
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">string</font></font><font face="Courier New" size="2" color="#000000">&nbsp;ext=<font face="Courier New" size="2" color="#2B91AF">Path</font></font><font face="Courier New" size="2" color="#000000">.GetExtension(file).ToLowerInvariant();
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">if</font></font><font face="Courier New" size="2" color="#000000">((ext==<font face="Courier New" size="2" color="#A31515">".esp"</font></font><font face="Courier New" size="2" color="#000000">||ext==<font face="Courier New" size="2" color="#A31515">".esm"</font></font><font face="Courier New" size="2" color="#000000">)&amp;&amp;file.IndexOfAny(seperators)==-1)&nbsp;{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetPluginActivation(file,&nbsp;<font face="Courier New" size="2" color="#0000FF">true</font></font><font face="Courier New" size="2" color="#000000">);
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2" color="#0000FF">return</font></font><font face="Courier New" size="2" color="#000000">&nbsp;<font face="Courier New" size="2" color="#0000FF">true</font></font><font face="Courier New" size="2" color="#000000">;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
}</font><font face="Arial" size="2" color="#000000">
<br>
</font></font>

</body></html>
